<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>New Age - Start Bootstrap Theme</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico"/>
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet"/>
    <!-- Google fonts-->
    <link rel="preconnect" href="https://fonts.gstatic.com"/>
    <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&amp;display=swap"
          rel="stylesheet"/>
    <link
        href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&amp;display=swap"
        rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&amp;display=swap"
          rel="stylesheet"/>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet"/>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>


    <style>

        .bar {
            fill: steelblue;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 2px;
        }

        .axis text {
            font-size: 12px;
        }

        .axis path,
        .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .card {
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background-color: #ffffff;
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            height: 300px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }

        button {
            padding: 10px 20px;
            background-color: #22ff00;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        .stop-btn {
            background-color: #FF5733;
        }

        .stop-btn:hover {
            background-color: #d43f00;
        }

        canvas {
            display: block;
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body id="page-top">
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light fixed-top shadow-sm" id="mainNav">
    <div class="container px-5">
        <a class="navbar-brand fw-bold" href="#page-top">VIH DATA VISUALISATION</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="bi-list"></i>
        </button>

    </div>
</nav>
<!-- Mashead header-->
<header class="masthead">
    <div class="container px-5 my-5">
        <!-- Title -->
        <div class="text-center mb-5">
            <h1 class="display-4">Analyse des Décès liés au VIH</h1>
            <p class="lead text-muted">Visualisation des données sur les décès dus au VIH par pays, continent, année et
                région.</p>
        </div>

        <!-- Rows for Charts -->
        <div class="row gx-5">
            <div id="chart1" class="col-lg-4 mb-5 chart"></div>
            <div id="chart2" class="col-lg-4 mb-5 chart"></div>
            <div id="chart3" class="col-lg-4 mb-5 chart"></div>

        </div>
        <div class="row gx-5">
            <div id="chart4" class="col-lg-4 mb-5 chart"></div>
            <div id="chart5" class="col-lg-4 mb-5 chart">
                <img src="data/chart.jpg" alt="" style="height: 300px; width: 400px">
            </div>
            <div id="chart6" class="col-lg-4 mb-5 chart"></div>
        </div>
    </div>
    <div class="container px-5 my-5">
        <!-- Title -->
        <div class="text-center mb-5">
            <h1 class="display-4">Analyse des Personnes Vivant avec le VIH</h1>
            <p class="lead text-muted">Visualisation des données des personnes vivant avec le VIH par pays, année et
                région.</p>
        </div>

        <!-- Rows for Charts -->
        <div class="row gx-5">
            <div id="chart7" class="col-lg-4 mb-5 chart"></div>
            <div id="chart8" class="col-lg-4 mb-5 chart"></div>
            <div id="chart9" class="col-lg-4 mb-5 chart"></div>

        </div>

    </div>

</header>
<!-- Quote/testimonial aside-->
<aside class="text-center bg-gradient-primary-to-secondary">
    <div class="container px-5">
        <div class="row gx-5 justify-content-center">
            <div class="col-xl-8">
                <div class="h2 fs-1 text-white mb-4">Analyse Graphique des Femmes Enceintes Vivant avec le VIH et le
                    Besoin en Médicaments Préventifs
                </div>
            </div>
        </div>
    </div>
</aside>


<!--        </section>-->
<section id="features">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="flourish-embed" data-src="story/2837613">
                    <script src="https://public.flourish.studio/resources/embed.js"></script>
                    <noscript><img src="https://public.flourish.studio/story/2837613/thumbnail" width="100%"
                                   alt="visualization"/></noscript>
                </div>
            </div>

        </div>


        <div class="row">
            <div class="col-md-6">
                <div class='tableauPlaceholder' id='viz1737718628046' style='position: relative'>
                    <noscript><a href='#'><img alt='Évolution VIH, Décès, Carte géographique (2010-2019) '
                                               src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ev&#47;EvolutionduVIH2010-2018&#47;volutionVIHDcsCartegographique2010-2019&#47;1_rss.png'
                                               style='border: none'/></a></noscript>
                    <object class='tableauViz' style='display:none;'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F'/>
                        <param name='embed_code_version' value='3'/>
                        <param name='site_root' value=''/>
                        <param name='name'
                               value='EvolutionduVIH2010-2018&#47;volutionVIHDcsCartegographique2010-2019'/>
                        <param name='tabs' value='no'/>
                        <param name='toolbar' value='yes'/>
                        <param name='static_image'
                               value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Ev&#47;EvolutionduVIH2010-2018&#47;volutionVIHDcsCartegographique2010-2019&#47;1.png'/>
                        <param name='animate_transition' value='yes'/>
                        <param name='display_static_image' value='yes'/>
                        <param name='display_spinner' value='yes'/>
                        <param name='display_overlay' value='yes'/>
                        <param name='display_count' value='yes'/>
                        <param name='language' value='en-US'/>
                    </object>
                </div>
                <script
                    type='text/javascript'>                    var divElement = document.getElementById('viz1737718628046');
                var vizElement = divElement.getElementsByTagName('object')[0];
                if (divElement.offsetWidth > 800) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else if (divElement.offsetWidth > 500) {
                    vizElement.style.width = '1000px';
                    vizElement.style.height = '827px';
                } else {
                    vizElement.style.width = '100%';
                    vizElement.style.height = '1127px';
                }
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
            </div>
        </div>


    </div>

    <div class="row">
        <!--                    <div class="flourish-embed flourish-map" data-src="visualisation/21283812"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/21283812/thumbnail" width="100%" alt="map visualization" /></noscript></div>-->
        <div id="chartContainer" style="height: 400px; width: 100%;"></div>

    </div>

</section>

<!-- Basic features section-->

<aside class="text-center bg-info">
    <div class="container px-5">
        <div class="row gx-5 justify-content-center">
            <div class="col-xl-8">
                <div class="h2 fs-1 text-white mb-4">Entrez votre texte pour créer un nuage de mots animé</div>
            </div>
        </div>
    </div>
</aside>

<section class="bg-light">
    <div class="container px-5">
        <div class="row gx-5 align-items-center justify-content-center justify-content-lg-between">
            <!-- Card for entering text -->
            <div class="col-12 col-lg-5">
                <div class="card">
                    <textarea id="textInput" placeholder="Écrivez quelque chose..."></textarea>
                    <button id="submitBtn" class="w-100 btn btn-primary">Soumettre</button>
                    <button id="stopBtn" class="w-100 btn btn-danger mt-2">Arrêter l'animation</button>
                </div>
            </div>

            <!-- Card for the word cloud animation -->
            <div class="col-sm-8 col-md-6">
                <div class="card">
                    <canvas id="myCanvas"></canvas>
                </div>
            </div>
        </div>
    </div>

</section>
<!-- Call to action section-->
<section class="bg-gradient-primary-to-secondary" id="download">
    <div class="container px-5">
        <h2 class="text-center text-white font-alt mb-4">
            <a href=" https://mbarry01.github.io/dashboard-dynamique/" style="color: white">Text graph</a>
        </h2>
        <div class="d-flex flex-column flex-lg-row align-items-center justify-content-center">
        </div>
    </div>
</section>
<!-- Footer-->
<footer class="bg-black text-center py-5">
    <div class="container px-5">
        <div class="text-white-50 small">
            <div class="mb-2">&copy; Your Website 2023. All Rights Reserved.</div>
            <a href="#!">Privacy</a>
            <span class="mx-1">&middot;</span>
            <a href="#!">Terms</a>
            <span class="mx-1">&middot;</span>
            <a href="#!">FAQ</a>
        </div>
    </div>
</footer>
<!-- Feedback Modal-->
<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-gradient-primary-to-secondary p-4">
                <h5 class="modal-title font-alt text-white" id="feedbackModalLabel">Send feedback</h5>
                <button class="btn-close btn-close-white" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="js/scripts.js"></script>
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<!-- * *                               SB Forms JS                               * *-->
<!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
<!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
<!--        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>-->

<script>
    const csvPath1 = "./data/vih_no_of_deaths_by_country_clean.csv";

    // Load CSV and parse data
    d3.csv(csvPath1, d => ({
        Pays: d.Country,
        Année: +d.Year,
        Décès_médian: +d.Count.match(/(\d+)\[/)[1],
        Décès_min: +d.Count.match(/\[(\d+)–/)[1],
        Décès_max: +d.Count.match(/–(\d+)\]/)[1],
        Région_OMS: d["WHO Region"]
    })).then(data => {
        // Prepare data for the charts
        const topCountriesDeaths = getTopItemsDeaths(data, "Pays", 5);
        const topRegionsDeaths = getTopItemsDeaths(data, "Région_OMS", 5);
        const yearlyTrendDeaths = getYearlyTrendDeaths(data);
        const regionDistributionDeaths = getRegionDistributionDeaths(data);
        // const minMaxComparisonDeaths = getMinMaxComparisonDeaths(data);
        // const yearlyMaxDeaths = getYearlyMaxDeathsDeaths(data);

        // Create the charts
        createBarChartDeaths(topCountriesDeaths, "#chart1", "Top 5 Pays les Plus Touchés");
        createBarChartDeaths(topRegionsDeaths, "#chart2", "Top 5 Régions les Plus Touchées");
        createLineChartDeaths(yearlyTrendDeaths, "#chart3", "Tendance des Décès par Année");
        createPieChartDeaths(regionDistributionDeaths, "#chart4", "Répartition par Région (OMS)");
        // createBarChartDeaths(minMaxComparisonDeaths, "#chart5", "Comparaison Min/Max des Décès");
        // createLineChartDeaths(yearlyMaxDeaths, "#chart6", "Maximum des Décès par Année");
    });

    // Helper functions for data aggregation
    function getTopItemsDeaths(data, field, count) {
        const aggregated = d3.rollup(data, v => d3.sum(v, d => d.Décès_médian), d => d[field]);
        return Array.from(aggregated, ([key, value]) => ({key, value}))
            .sort((a, b) => b.value - a.value)
            .slice(0, count);
    }

    function getYearlyTrendDeaths(data) {
        const aggregated = d3.rollup(data, v => d3.sum(v, d => d.Décès_médian), d => d.Année);
        return Array.from(aggregated, ([year, count]) => ({year, count})).sort((a, b) => a.year - b.year);
    }

    function getRegionDistributionDeaths(data) {
        const aggregated = d3.rollup(data, v => d3.sum(v, d => d.Décès_médian), d => d.Région_OMS);
        return Array.from(aggregated, ([region, count]) => ({region, count}));
    }

    // function getMinMaxComparisonDeaths(data) {
    //     return data.map(d => ({ key: d.Pays, min: d.Décès_min, max: d.Décès_max }));
    // }

    // function getYearlyMaxDeathsDeaths(data) {
    //     const aggregated = d3.rollup(data, v => d3.max(v, d => d.Décès_max), d => d.Année);
    //     return Array.from(aggregated, ([year, max]) => ({ year, max })).sort((a, b) => a.year - b.year);
    // }

    // Chart Functions
    function createBarChartDeaths(data, selector, title) {
        const margin = {top: 40, right: 20, bottom: 40, left: 50};
        const width = 400 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select(selector)
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        svg.append("text")
            .attr("x", width / 2)
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .text(title);

        const x = d3.scaleBand()
            .domain(data.map(d => d.key))
            .range([0, width])
            .padding(0.1);

        const y = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.value)])
            .range([height, 0]);

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x));

        svg.append("g").call(d3.axisLeft(y));

        svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.key))
            .attr("y", d => y(d.value))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.value));
    }

    function createLineChartDeaths(data, selector, title) {
        const margin = {top: 40, right: 20, bottom: 40, left: 50};
        const width = 400 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select(selector)
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        svg.append("text")
            .attr("x", width / 2)
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .text(title);

        const x = d3.scaleLinear()
            .domain(d3.extent(data, d => d.year))
            .range([0, width]);

        const y = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.count)])
            .range([height, 0]);

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickFormat(d3.format("d")));

        svg.append("g").call(d3.axisLeft(y));

        const line = d3.line()
            .x(d => x(d.year))
            .y(d => y(d.count));

        svg.append("path")
            .datum(data)
            .attr("class", "line")
            .attr("d", line)
            .attr("stroke", "steelblue")
            .attr("fill", "none");
    }

    function createPieChartDeaths(data, selector, title) {
        const width = 300;
        const height = 300;
        const radius = Math.min(width, height) / 2;

        const svg = d3.select(selector)
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", `translate(${width / 2},${height / 2})`);

        svg.append("text")
            .attr("x", 0)
            .attr("y", -height / 2 + 20)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .text(title);

        const color = d3.scaleOrdinal(d3.schemeCategory10);

        const pie = d3.pie()
            .value(d => d.count);

        const arc = d3.arc()
            .innerRadius(0)
            .outerRadius(radius);

        const dataReady = pie(data);

        svg.selectAll("path")
            .data(dataReady)
            .join("path")
            .attr("d", arc)
            .attr("fill", d => color(d.data.region))
            .style("opacity", 0.8);

        const legend = svg.selectAll(".legend")
            .data(data)
            .enter()
            .append("g")
            .attr("class", "legend")
            .attr("transform", (d, i) => `translate(-100,${i * 20 - 100})`);

        legend.append("rect")
            .attr("x", 0)
            .attr("y", 0)
            .attr("width", 18)
            .attr("height", 18)
            .style("fill", d => color(d.region));

        legend.append("text")
            .attr("x", 25)
            .attr("y", 13)
            .text(d => d.region)
            .style("font-size", "12px");
    }
</script>

<script>
    const csvPath2 = "./data/vih_no_of_people_living_with_hiv_by_country_clean.csv";

    // Load CSV and parse data
    d3.csv(csvPath2, d => ({
        Pays: d.Country,
        Année: +d.Year,
        Médian: +d.Count_median,
        Min: +d.Count_min,
        Max: +d.Count_max,
        Région_OMS: d["WHO Region"]
    })).then(data => {
        // Prepare data for the charts
        const topCountriesHIV = getTopItemsHIV(data, "Pays", 5);
        const topRegionsHIV = getTopItemsHIV(data, "Région_OMS", 5);
        const yearlyTrendHIV = getYearlyTrendHIV(data);

        // Create the charts
        createBarChartHIV(topCountriesHIV, "#chart7", "Top 5 Pays avec le Plus de Personnes Vivant avec le VIH");
        createBarChartHIV(topRegionsHIV, "#chart8", "Top 5 Régions OMS avec le Plus de Personnes Vivant avec le VIH");
        createLineChartHIV(yearlyTrendHIV, "#chart9", "Tendance des Personnes Vivant avec le VIH par Année");
    });

    // Helper functions for data aggregation
    function getTopItemsHIV(data, field, count) {
        const aggregated = d3.rollup(data, v => d3.sum(v, d => d.Médian), d => d[field]);
        return Array.from(aggregated, ([key, value]) => ({key, value}))
            .sort((a, b) => b.value - a.value)
            .slice(0, count);
    }

    function getYearlyTrendHIV(data) {
        const aggregated = d3.rollup(data, v => d3.sum(v, d => d.Médian), d => d.Année);
        return Array.from(aggregated, ([year, count]) => ({year, count})).sort((a, b) => a.year - b.year);
    }

    // Chart Functions
    function createBarChartHIV(data, selector, title) {
        const margin = {top: 40, right: 20, bottom: 40, left: 50};
        const width = 400 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select(selector)
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        svg.append("text")
            .attr("x", width / 2)
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .text(title);

        const x = d3.scaleBand()
            .domain(data.map(d => d.key))
            .range([0, width])
            .padding(0.1);

        const y = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.value)])
            .range([height, 0]);

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x));

        svg.append("g").call(d3.axisLeft(y));

        svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.key))
            .attr("y", d => y(d.value))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.value));
    }

    function createLineChartHIV(data, selector, title) {
        const margin = {top: 40, right: 20, bottom: 40, left: 50};
        const width = 400 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select(selector)
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        svg.append("text")
            .attr("x", width / 2)
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .style("font-size", "16px")
            .text(title);

        const x = d3.scaleLinear()
            .domain(d3.extent(data, d => d.year))
            .range([0, width]);

        const y = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.count)])
            .range([height, 0]);

        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickFormat(d3.format("d")));

        svg.append("g").call(d3.axisLeft(y));

        const line = d3.line()
            .x(d => x(d.year))
            .y(d => y(d.count));

        svg.append("path")
            .datum(data)
            .attr("class", "line")
            .attr("d", line)
            .attr("stroke", "steelblue")
            .attr("fill", "none");
    }
</script>

<script>
    // Path to your dataset
    const csvPath3 = "./data/no_of_cases_adults_15_to_49_by_country_clean.csv";

    // Load CSV and parse data
    d3.csv(csvPath3, d => ({
        Country: d.Country,
        Year: +d.Year,
        Count: +d.Count,
        Count_median: +d.Count_median,
        Count_min: +d.Count_min,
        Count_max: +d.Count_max,
        WHO_Region: d["WHO Region"]
    })).then(data => {
        // Aggregate the data to get the top countries with the highest median count
        const aggregatedData = d3.rollup(
            data,
            v => d3.sum(v, d => d.Count_median), // Sum up median counts
            d => d.Country // Group by country
        );

        // Convert to an array and sort by median count in descending order
        const sortedData = Array.from(aggregatedData, ([key, value]) => ({Country: key, Count_median: value}))
            .sort((a, b) => b.Count_median - a.Count_median)
            .slice(0, 10); // Take the top 10 countries

        // Prepare data for CanvasJS
        const chartData = sortedData.map(d => ({
            label: d.Country,
            y: d.Count_median
        }));

        // Create a bar chart using CanvasJS
        const chart = new CanvasJS.Chart("chartContainer", {
            animationEnabled: true,
            theme: "light2",
            title: {
                text: "Top 10 Countries with Highest Median Cases (Adults 15-49)"
            },
            axisX: {
                title: "Countries",
                labelAngle: -45
            },
            axisY: {
                title: "Median Count",
                includeZero: true
            },
            data: [{
                type: "column",
                dataPoints: chartData
            }]
        });

        chart.render();
    });
</script>
<script>
    const canvas = document.getElementById('myCanvas');
    const ctx = canvas.getContext('2d');
    const textInput = document.getElementById('textInput');
    const submitBtn = document.getElementById('submitBtn');
    const stopBtn = document.getElementById('stopBtn');

    // Set canvas dimensions to match the container
    canvas.width = 800;
    canvas.height = 400;

    // Initialize canvas background
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Create a class to handle words falling inside circles
    class Word {
        constructor(text, x, y, speed, color, size) {
            this.text = text;
            this.x = x;
            this.y = y;
            this.speed = speed;
            this.color = color;
            this.size = size; // Size based on frequency
        }

        draw() {
            ctx.fillStyle = this.color;
            ctx.font = '16px Arial';
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); // Draw circle around the word
            ctx.fill();
            ctx.fillStyle = '#ffffff'; // Color of the text inside the circle
            ctx.fillText(this.text, this.x - ctx.measureText(this.text).width / 2, this.y + 5);
        }

        update() {
            this.y += this.speed;
            if (this.y > canvas.height) {
                this.y = -20; // Reset to top if word goes off the screen
            }
        }
    }

    const words = [];
    let animationId;
    const wordFrequency = {}; // Object to track word frequencies

    // Function to generate a random color
    function getRandomColor() {
        const letters = '0123456789ABCDEF';
        let color = '#';
        for (let i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    }

    // Function to determine circle size based on word frequency
    function getCircleSize(frequency) {
        return Math.min(30 + frequency * 10, 80); // Max size of the circle
    }

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
        for (let word of words) {
            word.update(); // Update word position
            word.draw();   // Draw the word on canvas
        }
        animationId = requestAnimationFrame(animate); // Recursively call animate
    }

    submitBtn.addEventListener('click', () => {
        const text = textInput.value;
        if (text.trim()) {
            const splitWords = text.split(' '); // Split input text into words
            splitWords.forEach((word) => {
                // Update frequency of each word
                wordFrequency[word] = (wordFrequency[word] || 0) + 1;

                const x = Math.random() * (canvas.width - 100); // Random X position
                const y = Math.random() * -canvas.height; // Random Y position (outside the screen)
                const speed = Math.random() * 2 + 1; // Random speed for each word
                const color = getRandomColor(); // Random color for each word
                const size = getCircleSize(wordFrequency[word]); // Circle size based on frequency

                words.push(new Word(word, x, y, speed, color, size));
            });
            if (!animationId) animate(); // Start animation if not already running
            textInput.value = ''; // Clear input after submission
        }
    });

    // Stop animation when the stop button is clicked
    stopBtn.addEventListener('click', () => {
        cancelAnimationFrame(animationId); // Stop animation
        animationId = null; // Reset the animation ID
    });
</script>


</body>
</html>
